<DOCTYPE html>
<html lang='en'>
<head>
    <title>AJAX</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- My Global CSS -->
    <link rel="stylesheet" type="text/css" href="https://thiago-meneses.github.io/myGlobalCSS.css" >

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,300&family=Roboto+Mono:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- TÍTULO -->
    <div class="container-xxl px-4">
        <h1 class="initialTitle">AJAX</h1>
        <h2>Asynchronous Javascript And XML</h2>
        <hr>
    </div>

    <!-- INFORMAÇÕES INICIAIS -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">Informações Iniciais</mark></h1>
            <div class="px-4 py-3">
                <ul>
                    <li>Funciona <b>apenas</b> dentro de um <b>servidor</b>.</li>
                    <li>Permite com que as páginas sejam atualizadas de forma <b class="red">ASSÍNCRONA</b>;</li>
                        <ul>
                            <li>Troca dados com um servidor em <b>segundo plano</b>;</li>
                            <li>Permite atualizar partes de uma página sem recarregar a página inteira.</li><br>
                        </ul>
                    <li>Pode ser usado tanto para:</li>
                        <ul>
                            <li>Captar dados de um <b>banco de dados</b>;</li>
                            <li>Captar dados de um <b>servidor</b>.</li>
                        </ul>
                    </li><br>
                    <li>Pode ser usado com:
                        <ul>
                            <li>Javascript;</li>
                            <li>JQuery.</li>
                        </ul>
                    </li><br>
                    <li><b>Não</b> é uma linguagem de programação.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- COMO FUNCIONA -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">Como Funciona?</mark></h1>
            <div class="px-4 py-3">
                <ul>
                    <li>O AJAX usa: </li>
                    <ul>
                        <li> O <b class="red">XMLHttpRequest</b> <b>Object</b> para <b>solicitar dados do servidor</b>;</li>
                        <ul>
                            <li>XMLHttpRequest já é embutido no browser.</li>
                        </ul><br>
                        <li> <b>Javascript</b> e <b>HTML DOM</b> para <b>exibir</b> ou <b>utilizar os dados</b>.</li>
                    </ul>

                </ul><br>
            </div>
        </div>
    </div>

    <!-- ETAPAS -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="ps-4"><mark class="lineText">Etapas</mark></h1>
            <div class="px-4 py-3">
                <ol>
                    <li class="mb-05em"> Um <b>evento ocorre</b> na página web ( ex: a página é carregada, um botão e clicado... ); </li>
                    <li class="mb-05em"> Um <b>XMLHttpRequest Object</b> é <b>criado</b> pelo Javascript; </li>
                    <li class="mb-05em"> O XMLHttpRequest Object <b>envia uma requisição para o servidor</b>; </li>
                    <li class="mb-05em"> O servidor <b>processa</b> a requisição; </li>
                    <li class="mb-05em"> O servidor envia uma <b>resposta à página web</b>; </li>
                    <li class="mb-05em"> A resposta é <b>lida pelo Javascript</b>; </li>
                    <li class="mb-05em"> A ação recebida é <b>executada</b> pelo Javascript. </li>
                </ol>
            </div>
        </div>
    </div>

    <!-- XMLHttpRequest -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">XMLHttpRequest</mark></h1>
            <div class="px-4 py-3">
                <!-- SINTAXE E CONCEITOS INICIAIS -->
                <div class="px-4 py-4">
                    <h2>Sintaxe</h2>
                    <code class="inlineCodeTag fs-4">variable = <b>new XMLHttpRequest</b>;</code>    
                    <ul class="pt-2 mt-3">
                        <li>Está presente em <b>todos browsers modernos;</b></li>
                        <li>Permite realizar a troca de dados com um servidor em <b>segundo plano.</b>
                            <ul><li>Não há a necessidade de recarregar a página.</li></ul>
                    </ul>
                </div>
                <hr>

                <!-- PROPRIEDADES DO XMLHttpRequest Object -->
                <div class="px-4 py-4">
                    <h2 class="mb-1em"><b class="red">Propriedades</b> do XMLHttpRequest Object</h2>
                    <ul>
                        <li class="mb-15em"><code class="inlineCodeTag">onload</code>
                            <ul>
                                <li>Define uma função que vai ser chamada quando a requisição for recebida </li>
                                <li>Essa função será uma <b>callback Function</b> </li>
                            </ul>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">responseText</code>
                            <ul><li>Retorna a resposta do servidor no formato <b>Javascript String</b> </li></ul>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">responseXML</code>
                            <ul> <li>Retorna a resposta do servidor no formato <b>XML DOM Object</b> </li></ul>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">readyState</code>
                            <ul>
                                <li>Armazena o estado do XMLHttpRequest</li>
                            </ul>
                            <p class="ps-4">
                                <b>0</b> = requisição não inicializada; <br>
                                <b>1</b> = conexão estabelecida com o servidor; <br>
                                <b>2</b> = requisição recebida; <br>
                                <b>3</b> = processando requisição; <br>
                                <b>4</b> = requisição concluída e resposta pronta. <br>
                            </p>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">onreadystatechange</code>
                            <ul>
                                <li>Define uma <b>função callback</b> a ser chamada sempre quando a propriedade <b>readyState for alterada</b> </li>
                                <li>É disparada <b>4 vezes</b>, uma para cada alteração no readyState</li>
                            </ul>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">status</code>
                            <ul><li>Retorna o <b>número do status</b> de uma requisição XMLHttpRequest Object <br></li></ul>
                            <p class="ps-4">
                                <b>200</b>: "OK" <br>
                                <b>403</b>: "Forbidden" <br>
                                <b>404</b>: "Not Found" <br>
                                lista completa → https://www.w3schools.com/tags/ref_httpmessages.asp <br>
                            </p>
                        </li>
                        <li class="mb-15em"><code class="inlineCodeTag">statusText</code>
                            <ul><li>Retorna a <b>mensagem de status</b> ("OK", "Not Found", ...)</li></ul>
                        </li>
                    </ul>
                </div>
                <hr>

                <!-- MÉTODOS DO XMLHttpRequest Object -->
                <div class="px-4 py-4">
                    <h2 class="mb-1em"><b class="red">Métodos</b> do XMLHttpRequest Object</h2>
                    <ul>
                        <li><code class="inlineCodeTag">new XMLHttpRequest()</code>
                        <ul class="mt-05em mb-3em"><li><b>Cria</b> um novo <b>XMLHttpRequest Object.</b></li></ul></li>
                        
                        <li class="mb-3em "><code class="inlineCodeTag">abort( )</code>
                        <ul class="mt-05em"><li><b>Cancela</b> a requisição atual.</li></ul></li>

                        <li class="mb-3em"><code class="inlineCodeTag">getAllResponseHeaders( )</code>
                        <ul class="mt-05em"><li>Retorna <b>TODOS OS HEADERS</b> obtidos na resposta do servidor.</li></ul></li>
                        
                        <li class="mb-3em"><code class="inlineCodeTag">getResponseHeader( nomeHeader )</code>
                        <ul class="mt-05em"><li>Retorna um <b>HEADER EM ESPECÍFICO</b> obtido na resposta do servidor.</li></ul></li>
                        
                        <li class="mb-3em"><code class="inlineCodeTag"> open( método, url, async, user, psw )</code>
                        <ul class="mt-05em"> 
                                <li class="mb-15em">Especifíca qual será a <b>requisição a ser feita</b> e os <b>dados necessários</b></li>           
                                <li>Parâmetros:</li>
                                <ol>
                                    <li class="mb-05em"><b>método:</b> tipo de requisição ( GET ou SET )</li>
                                    <li class="mb-05em"><b>url:</b> endereço do arquivo no servidor
                                        <ul><li>Pode ser qualquer tipo de arquivo ( txt, xml, assim como server scripting files asp, php... )</li></ul>
                                    </li>
                                    <li class="mb-05em"><b>async:</b> true (assíncrono) / false (assíncrono)
                                        <ul>
                                            <li>Parâmetro opcional</li>
                                            <li>Tem valor <b>true</b> por padrão</li>

                                                <!-- O modo assíncrono permite com que o javascript execute outros scripts enquanto aguarda a resposta do servidor, lidando com essa resposta depois que ela estiver pronta
                                                O modo síncrono não é recomendado pois o javascript irá parar de executar outras tarefas para aguardar que a resposta esteja pronta
                                                O modo síncrono as vezes pode ser usado para realizar testes <br>
                                                Pode ser encontrado em códigos mais antigos do javascript <br>
                                                Já que o código irá aguardar a conclusão do servidor, não há necessidade para a função onreadystatechange <br>
                                                Ferramentas de desenvolvimento modernas são incentivadas a alertar sobre o uso de solicitações síncronas, podendo lançar uma exceção InvalidAccessError quando isso ocorrer. <br> -->
                                        </ul>
                                    </li>
                                    <li class="mb-05em"><b>user:</b> nome de usuário 
                                        <ul><li>Parâmetro opcional</li></ul>
                                    </li>
                                    <li class="mb-05em"><b>psw:</b> password
                                        <ul><li>Parâmetro opcional</li></ul>
                                    </li>
                                </ol>
                        </ul></li>
                        
                        <li class="mb-15em"><code class="inlineCodeTag">send()</code>
                        <ul class="mt-05em">
                                <li>Envia a requisição ao servidor</li>
                                <li>Usado para requisições <b>GET</b></li>
                        </ul></li>

                        <li class="mb-15em"><code class="inlineCodeTag">send(string)</code>
                        <ul class="mt-05em">
                                <li>Envia a requisição ao servidor </li>
                                <li>Usado para requisições <b>POST</b></li>
                        </ul></li>

                        <li class="mb-15em"><code class="inlineCodeTag">setRequestHeader( header, value )</code>
                            <ul class="mt-05em">
                                <li>Adiciona um label/value pair ao header que está a ser enviado <br></li>
                                <li>Adiciona headers HTTP para a requisição <br></li>
                                <li>Parâmetros</li>
                                <ul>
                                    <li><b>header:</b> Especifica o nome do header</li>	
                                    <li><b>value:</b> Especifica o valor do header</li>
                                </ul>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- VÁRIAS FUNÇÕES CALLBACK -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">Várias Funções Callback</mark></h1>
            <div class="px-4 py-3">
                <ul>
                    <li>Havendo mais de uma operação AJAX a ser feita na página: </li>   
                    <ul>
                        <li>Criar a função de execução do XMLHttpRequest object</li>
                        <li>Criar <b>uma função callback</b> para <b>cada operação AJAX</b> a ser feita</li>
                    </ul>
                </ul>
            </div>
        </div>
    </div>

    <!-- REQUISIÇÃO AO SERVIDOR -->
    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">Requisição ao Servidor</mark></h1>
            <div class="px-4 py-3">
                <ul class="px-4">
                    <li>Uma requisição é enviada ao servidor usando:</li>
                    <ul><li>Os métodos <code class="inlineCodeTag">open()</code> e <code class="inlineCodeTag">send()</code> do XMLHttpRequest object</li></ul>
                    <p>Exemplo</p>
                    <pre class="preTag px-4">
                        <code>
xhttp.<b>open("GET", "file_name.txt", true)</b>;
xhttp.<b>send()</b>;
                        </code>
                    </pre>
                </ul>
            </div>
        </div>
    </div>

    <div class="container-xxl">
        <div class="bd-content">
            <div class="boundingLines"></div>
            <h1 class="px-4"><mark class="lineText">Fetch API</b></mark></h1>
            <div class="px-4 py-3">
                <ul class="px-4">   
                    <li>Browsers modernos usam <b>Fetch API</b> ao invés do XMLHttpRequest Object</li>
                    <ul>
                        <li>A Fetch API faz o mesmo e de forma <b>mais rápida</b></li>
                        <li>A interface do Fetch API permite com que o browser faça <b>requisições HTTP</b> para o <b>servidor</b></li>
                    </ul>  
                </ul>
            </div>
        </div>
    </div>

    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>